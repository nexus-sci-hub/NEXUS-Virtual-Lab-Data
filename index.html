<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS Science Hub | Secure Login</title>
    <style>
        :root { --accent: #00d4ff; --bg: #0b1118; --card: #1a242f; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .login-box { background: var(--card); padding: 40px; border-radius: 12px; border: 1px solid #303f4f; width: 320px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h2 { color: var(--accent); margin: 0 0 20px 0; letter-spacing: 1px; }
        input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 6px; border: none; background: #2c3e50; color: white; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: var(--accent); color: #003366; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        button:disabled { background: #444; color: #888; cursor: not-allowed; }
        .error { color: #ff4d4d; font-size: 13px; margin-top: 15px; display: none; padding: 10px; background: rgba(255,0,0,0.1); border-radius: 4px; }
        .loader { border: 3px solid #f3f3f3; border-top: 3px solid var(--accent); border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: none; margin: 15px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="login-box">
        <h2>NEXUS HUB</h2>
        <input type="email" id="email" placeholder="Member Email">
        <input type="password" id="pass" placeholder="Access Password">
        <button id="btn" onclick="authenticate()">AUTHENTICATE</button>
        <div id="loader" class="loader"></div>
        <div id="err" class="error"></div>
    </div>

    <script>
        // CONFIG - CHANGE THESE IF NEEDED
        const JSON_URL = "https://raw.githubusercontent.com/nexus-sci-hub/NEXUS-Virtual-Lab-Data/main/members.json";
        const REDIRECT_TO = "https://www.shuvadipganguli.world/nexus-science-hub/nexus-virtual-lab";

        async function authenticate() {
            const btn = document.getElementById('btn');
            const loader = document.getElementById('loader');
            const errDiv = document.getElementById('err');
            const emailInput = document.getElementById('email').value.trim().toLowerCase();
            const passInput = document.getElementById('pass').value.trim();

            if (!emailInput || !passInput) { alert("Please fill in both fields."); return; }

            // UI State
            errDiv.style.display = "none";
            loader.style.display = "block";
            btn.disabled = true;

            try {
                // Fetching data with cache-buster
                const response = await fetch(`${JSON_URL}?t=${Date.now()}`);
                if (!response.ok) throw new Error("Database connection failed. Is the GitHub repo Public?");

                const data = await response.json();
                const members = data.members || data;

                const user = members.find(m => m.email.toLowerCase() === emailInput && String(m.pass) === passInput);

                if (user) {
                    btn.innerHTML = "ACCESS GRANTED";
                    btn.style.background = "#28a745";
                    btn.style.color = "white";
                    loader.style.display = "none";

                    // The "Breakout" Redirect: Works even if embedded in other sites
                    setTimeout(() => {
                        window.top.location.href = REDIRECT_TO;
                    }, 800);
                } else {
                    throw new Error("Invalid Credentials.");
                }
            } catch (e) {
                console.error(e);
                loader.style.display = "none";
                btn.disabled = false;
                errDiv.innerText = e.message;
                errDiv.style.display = "block";
            }
        }
    </script>
</body>
</html>
